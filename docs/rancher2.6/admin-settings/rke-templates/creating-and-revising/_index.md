---
title: 创建和修改 RKE 模板
weight: 32
---

本节介绍如何管理 RKE 模板和修订版。你可以从 **RKE1 配置 > RKE 模板**下的**集群管理**视图创建、共享、更新和删除模板。

模板更新通过修订系统处理。当模板所有者想要更改或更新模板时，他们会创建模板的新版本。单个修订无法编辑。但是，如果你想防止使用修订来创建新集群，你可以禁用它。

你可以使用两种方式来使用模板修订：创建新集群，或升级使用较早版本的模板创建的集群。模板创建者可以设置默认修订版，但是在最终用户创建集群时，他们可以选择任何模板以及可供使用的任何模板修订版。使用指定的修订版创建集群后，就无法将其更改为另一个模板，但是可以将集群升级为同一模板的较新的可用修订版。

模板所有者对模板修订版具有完全控制权，并且可以创建新的修订版来更新模板，删除或禁用不应被用于创建集群的修订版，和设置默认的模板修订版。

本节涵盖以下主题：

- [前提](#prerequisites)
- [创建模板](#creating-a-template)
- [更新模板](#updating-a-template)
- [删除模板](#deleting-a-template)
- [基于默认版创建新修订版](#creating-a-revision-based-on-the-default-revision)
- [基于克隆版创建新修订版](#creating-a-revision-based-on-a-cloned-revision)
- [禁用模板修订版](#disabling-a-template-revision)
- [重新启用禁用的模板修订版](#re-enabling-a-disabled-template-revision)
- [将模板修订版设置为默认](#setting-a-template-revision-as-default)
- [删除模板修订版](#deleting-a-template-revision)
- [升级集群以使用新的模板修订版](#upgrading-a-cluster-to-use-a-new-template-revision)
- [将正在运行的集群导出到新的 RKE 模板和修订版](#exporting-a-running-cluster-to-a-new-rke-template-and-revision)

### 前提

如果你具有**创建 RKE 模板**权限，则可以创建 RKE 模板，该权限可由[管理员授予]({{<baseurl>}}/rancher/v2.6/en/admin-settings/rke-templates/creator-permissions)。

如果你是模板的所有者，你可以修改、共享和删除模板。有关如何成为模板所有者的详细信息，请参阅[共享模板所有权文档]({{<baseurl>}}/rancher/v2.6/en/admin-settings/rke-templates/template-access-and-sharing/#sharing-ownership-of-templates)。

### 创建模板

1. 点击左上角 **☰ > 集群管理**。
1. 单击 **RKE1 配置 > 节点模板**。
1. 单击**添加模板**。
1. 输入模板的名称。Rancher 已经为模板的第一个版本自动生成了名称，该版本与该模板一起创建。
1. 可选：通过将用户添加为成员，来[与其他用户或组共享模板]({{<baseurl>}}/rancher/v2.6/en/admin-settings/rke-templates/template-access-and-sharing/#sharing-templates-with-specific-users-or-groups)。你还可以将模板公开，从而与 Rancher 中的所有人共享。
1. 然后按照屏幕上的表格将集群配置参数保存为模板修订的一部分。可以将修订标记为此模板的默认值。

**结果**：配置了具有一个修订版的 RKE 模板。你可以稍后在[配置 Rancher 启动的集群]({{<baseurl>}}/rancher/v2.6/en/cluster-provisioning/rke-clusters)时使用此 RKE 模板修订版。通过 RKE 模板管理集群后，集群无法解除与模板的绑定，并且无法取消选中**使用现有 RKE 模板和修订版**。

### 更新模板

更新 RKE 模板相当于创建现有模板的修订版。使用旧版本模板创建的集群可以进行更新，从而匹配新版本。

你不能编辑单个修订。由于你无法编辑模板的单个修订，为了防止使用某个修订，你可以[禁用该修订版](#disabling-a-template-revision)。

创建新模板修订时，使用旧模板修订的集群不受影响。

1. 点击左上角 **☰ > 集群管理**。
1. 在左侧导航栏，单击 **RKE1 配置 > RKE 模板**。
1. 转到要编辑的模板，然后单击 **⋮ > 编辑**。
1. 编辑所需信息并单击**保存**。
1. 可选：你可以更改此模板的默认修订版，也可以更改共享对象。

**结果**：模板已更新。要将其应用到使用旧版本模板的集群，请参阅[升级集群以使用新的模板修订版](#upgrading-a-cluster-to-use-a-new-template-revision)。

### 删除模板

当不再需要为任何集群使用某个 RKE 模板时，可以将其删除。

1. 点击左上角 **☰ > 集群管理**。
1. 单击 **RKE1 配置 > RKE 模板**。
1. 转到要删除的 RKE 模板，然后单击 **⋮ > 删除**。
1. 确认删除。

**结果**：模板被删除。

### 基于默认版创建新修订版

你可以复制默认模板修订版并快速更新其设置，而无需从头开始创建新修订版。克隆模板为你省去了重新输入集群创建所需的访问密钥和其他参数的麻烦。

1. 点击左上角 **☰ > 集群管理**。
1. 在左侧导航栏，单击 **RKE1 配置 > RKE 模板**。
1. 转到要克隆的 RKE 模板，然后单击 **⋮ > 基于默认版创建新修订版**。
1. 填写表单的其余部分来创建新修订。

**结果**：克隆并配置了 RKE 模板修订版。

### 基于克隆版创建新修订版

通过用户设置创建新的 RKE 模板修订版时，可以克隆现有修订版并快速更新其设置，而无需从头开始创建新的修订版。克隆模板修订省去了重新输入集群参数的麻烦。

1. 点击左上角 **☰ > 集群管理**。
1. 在 **RKE1 配置**下，单击 **RKE 模板**。
1. 转到要克隆的模板修订。然后选择 **⋮ > 克隆修订版**。
1. 填写表单的其余部分。

**结果**：克隆并配置了 RKE 模板修订版。你可以在配置集群时使用 RKE 模板修订。任何使用此 RKE 模板的现有集群都可以升级到此新版本。

### 禁用模板修订版

当你不需要将 RKE 模板修订版本用于创建新集群时，可以禁用模板修订版。你也可以重新启用禁用了的修订版。

如果没有任何集群使用该修订，你可以禁用该修订。

1. 点击左上角 **☰ > 集群管理**。
1. 在左侧导航栏，单击 **RKE1 配置 > RKE 模板**。
1. 转到要禁用的模板修订版。然后选择 **⋮ > 禁用**。

**结果**：RKE 模板修订版不能用于创建新集群。

### 重新启用禁用的模板修订版

如果要使用已禁用的 RKE 模板修订版来创建新集群，你可以重新启用该修订版。

1. 点击左上角 **☰ > 集群管理**。
1. 在 **RKE1 配置**下，单击 **RKE 模板**。
1. 转到要重新启用的模板修订。然后选择 **⋮ > 启用**。

**结果**：RKE 模板修订版可用于创建新集群。

### 将模板修订版设置为默认

当最终用户使用 RKE 模板创建集群时，他们可以选择使用哪个版本来创建集群。你可以配置默认使用的版本。

要将 RKE 模板修订版设置为默认：

1. 点击左上角 **☰ > 集群管理**。
1. 在左侧导航栏，单击 **RKE1 配置 > RKE 模板**。
1. 转到要设为默认的 RKE 模板修订版，然后单击 **⋮ > 设为默认配置**。

**结果**：使用模板创建集群时，RKE 模板修订版将用作默认选项。

### 删除模板修订版

你可以删除模板的所有修订（默认修订除外）。

要永久删除修订版：

1. 点击左上角 **☰ > 集群管理**。
1. 在左侧导航栏，单击 **RKE1 配置 > RKE 模板**。
1. 转到要删除的 RKE 模板修订版，然后单击 **⋮ > 删除**。

**结果**：RKE 模板修订版被删除。

### 升级集群以使用新的模板修订版

> 本部分假设你已经有一个集群，该集群[应用了 RKE 模板]({{<baseurl>}}/rancher/v2.6/en/admin-settings/rke-templates/applying-templates)。
> 本部分还假设你已[更新了集群使用的模板](#updating-a-template)，以便可以使用新的模板修订版。

要将集群升级到使用新的模板修订版：

1. 点击左上角 **☰ > 集群管理**。
1. 转到要升级的集群，然后单击 **⋮ > 编辑配置**。
1. 在**集群选项**中，单击模板修订版的下拉菜单，然后选择新的模板修订版。
1. 单击**保存**。

**结果**：集群已升级为使用新模板修订版中定义的设置。

### 将正在运行的集群导出到新的 RKE 模板和修订版

你可以将现有集群的设置保存为 RKE 模板。

这将把集群的设置导出为新的 RKE 模板，并且将集群绑定到该模板。然后，只有[更新了模板]({{<baseurl>}}/rancher/v2.6/en/admin-settings/rke-templates/creating-and-revising/#updating-a-template)并且集群升级到**使用更新版本的模板**时，集群才能改变。

要将现有集群转换为使用 RKE 模板：

1. 点击左上角 **☰ > 集群管理**。
1. 转到将被转换为使用 RKE 模板的集群，然后 **⋮ > 保存为 RKE 模板**。
1. 在出现的表单中输入 RKE 模板的名称，然后单击**创建**。

**结果**：

- 创建了一个新的 RKE 模板。
- 将集群转换为使用该新模板。
- 可以[使用新模板和修订版创建新集群。]({{<baseurl>}}/rancher/v2.6/en/admin-settings/rke-templates/applying-templates/#creating-a-cluster-from-an-rke-template)
