---
title: 配置全局默认私有镜像仓库
weight: 40
---

你可以使用私有容器镜像仓库，在组织内共享你的自定义系统镜像。借助私有镜像仓库，你可以让集群使用私有的、一致的、且来源可信的、集中的系统镜像。

在 Rancher 中设置私有镜像仓库的主要方法有两种：通过全局视图中的**设置**选项卡设置全局默认镜像仓库，以及在集群级别设置的高级选项中设置私有镜像仓库。全局默认镜像仓库可以用于离线设置，不需要凭证的镜像仓库。而集群级私有镜像仓库用于所有需要凭证的私有镜像仓库。

本文介绍了全局默认私有镜像仓库的配置，重点介绍安装 Rancher 后如何从 Rancher UI 配置镜像仓库。

有关在安装 Rancher 期间使用命令行选项设置私有镜像仓库的说明，请参见[离线安装指南]({{<baseurl>}}/rancher/v2.6/en/installation/other-installation-methods/air-gap)。

如果你的私有镜像仓库需要凭证，则它不能用作默认镜像仓库。没有全局的方法来为每个 Rancher 所配置的集群设置具有授权认证的私有镜像仓库。因此，如果你希望 Rancher 配置的集群使用凭证从私有镜像仓库中拉取镜像，则每次创建新集群时都必须[通过高级集群选项传递镜像仓库凭证](#setting-a-private-registry-with-credentials-when-deploying-a-cluster)。

## 将不需要凭证的私有镜像仓库设置为默认镜像仓库

1. 登录 Rancher 并配置默认管理员密码。
1. 单击 **☰ > 全局设置**。
1. 转到名为 `system-default-registry` 的设置，然后选择 **⋮ > 编辑设置**。
1. 将值更改为你的镜像仓库（例如 `registry.yourdomain.com:port`）。不要在镜像仓库前加上 `http://` 或 `https://`。

**结果**：Rancher 将使用你的私有镜像仓库拉取系统镜像。

## 部署集群时设置需要凭证的私有镜像仓库

创建集群时，你可以按照以下步骤配置私有镜像仓库：

1. 点击 **☰ > 集群管理**。
1. 在**集群**页面上，单击**创建**。
1. 选择集群类型。
1. 在**集群配置**中，转到**镜像仓库**选项卡，然后单击**为 Rancher 从私有镜像仓库中拉取镜像**。
1. 输入镜像仓库主机名和凭证。
1. 单击**创建**。

**结果**：新集群将能够从私有镜像仓库中拉取镜像。

集群创建后无法配置私有镜像仓库。
