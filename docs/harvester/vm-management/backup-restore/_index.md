---
title: 备份与恢复
description:
keywords:
  - rancher
  - rancher中文
  - rancher中文文档
  - rancher官网
  - rancher文档
  - Rancher
  - rancher 中文
  - rancher 中文文档
  - rancher cn
  - Harvester
  - 备份与恢复
---

## 概述

_从 0.2.0 版起可用_

虚拟机备份是在**虚拟机**页面上创建的。虚拟机备份卷将存储在**备份目标**（NFS 或 S3 服务器），它们可以用来恢复一个新的虚拟机或替换一个现有的虚拟机。

## 前提条件

必须设置一个备份目标。更多信息，见[配置备份目标](#配置备份目标)。如果没有设置 BackupTarget，你会看到一个提示信息。

## 配置备份目标

备份目标是一个用于访问 Harvester 中的备份存储的端点。备份存储是一个 NFS 服务器或 S3 兼容服务器，用于存储虚拟卷的备份。备份目标可以在 "Settings > backup-target"中设置。

| 参数               | 类型   | 描述                                                      |
| :----------------- | :----- | :-------------------------------------------------------- |
| Type               | string | 选择 S3 或 NFS                                            |
| Endpoint           | string | 端点是一个主机名或一个 IP 地址。对于 AWS S3，它可以留空。 |
| BucketName         | string | 桶名称                                                    |
| BucketRegion       | string | 桶所在的区域                                              |
| AccessKeyID        | string | AccessKeyID 就像一个用户 ID，用于识别你的账户。           |
| SecretAccessKey    | string | SecretAccessKey 是你账户的密码。                          |
| Certificate        | string | 如果你想使用你的 s3 服务器的自签名 SSL 证书，请粘贴该证书 |
| VirtualHostedStyle | bool   | 只使用虚拟主机式访问，如阿里云(Aliyun) OSS                |

## 创建虚拟机备份

1. 一旦设置了备份目标，进入 "虚拟机 "页面。
1. 点击虚拟机行动的 "Take Backup"，创建一个新的虚拟机备份。
1. 设置一个自定义的备份名称，然后点击`创建'来创建一个新的虚拟机备份。

**结果：**备份被创建。一个通知信息将被推广，用户可以到`高级>备份`页面查看所有的虚拟机备份。

一旦备份完成，"ReadyToUse "状态将被设置为 true。

用户可以选择恢复一个新的虚拟机，或使用该备份替换现有的虚拟机。

## 使用备份恢复虚拟机

要从备份中恢复一个新的虚拟机，请遵循以下步骤。

1. 转到 "备份 "页面。
1. 指定新的虚拟机名称，然后点击 "创建"。
1. 新的虚拟机将使用备份卷和元数据进行恢复，用户可以从 "虚拟机 "页面访问它。

## 使用备份覆盖原有虚拟机

您可以使用相同的虚拟机备份目标来替换现有的虚拟机。

您可以选择删除以前的卷或保留它们。默认情况下，所有以前的卷被删除。

**要求：**虚拟机必须存在，并要求处于断电状态。

1. 进入 "备份 "页面。
1. 点击 "创建"。

可以从 "虚拟机 "页面查看恢复过程。
