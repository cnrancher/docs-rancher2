---
title: 创建华为 CCE 集群
description: 您可以使用 Rancher 创建一个托管于 华为云 Cloud Container Engine (CCE)中的集群。Rancher 已经为 CCE 实现并打包了针对 CCE 的集群驱动]，但是默认情况下，这个集群驱动是`未启用的`。为了启动 CCE 集群，您需要先启用 CCE 集群驱动程序。启用集群驱动后，可以开始配置 CCE 集群。
keywords:
  - rancher
  - rancher中文
  - rancher中文文档
  - rancher官网
  - rancher文档
  - Rancher
  - rancher 中文
  - rancher 中文文档
  - rancher cn
  - 创建集群
  - 创建托管集群
  - 创建创建华为 CCE 集群
---

_从 v2.2.0 开始可用_

您可以使用 Rancher 创建一个托管于 华为云容器引擎（CCE）中的集群。Rancher 已经为 CCE 实现并打包了针对 CCE 的[集群驱动](/docs/rancher2/admin-settings/drivers/cluster-drivers/_index)，但是默认情况下，这个集群驱动是`未启用的`。为了启动 CCE 集群，您需要先[启用 CCE 集群驱动程序](/docs/rancher2/admin-settings/drivers/cluster-drivers/_index)。启用集群驱动后，才可以开始配置 CCE 集群。

## 先决条件

> **注意**
> 部署到 CCE 将会产生费用。

1. 在华为 CCE 门户中查找您的项目 ID，详情请参考关于如何[获取华为云账号、IAM 用户、项目、用户组、区域、委托的名称和 ID](https://support.huaweicloud.com/api-iam/iam_17_0002.html)的文档。

2. 创建[访问密钥](https://support.huaweicloud.com/api-iam/iam_03_0001.html).

## 局限性

华为 CCE 服务不支持通过 API 创建具有公共访问权限的集群。您需要在与要配置的 CCE 集群相同的 VPC 中运行 Rancher Server。

## 创建 CCE 集群

1. 从 **集群** 页面，单击 **添加集群**。

2. 选择 **华为 CCE**。

3. 输入 **集群名称**。

4. 通过**成员角色**来设置用户访问集群的权限。

   - 单击**添加成员**将需要访问这个集群的用户添加到成员中。
   - 在**角色**下拉菜单中选择每个用户的权限。

5. 输入 **项目 ID**，访问密钥 ID**Access Key**和访问密钥**Secret Key**。然后单击**下一步：配置集群**。

6. 填写以下集群配置：

   | 设置          | 描述                                                                                                     |
   | :------------ | :------------------------------------------------------------------------------------------------------- |
   | 集群类型      | 您要包含在集群中的类型或节点，`虚拟机` 或 `裸机` 。                                                      |
   | 描述          | 集群的描述。                                                                                             |
   | 主版本        | Kubernetes 版本。                                                                                        |
   | 管理规模计数  | 集群的最大节点计数。选项有 50、200 和 1000。规模越大，成本就越高。                                       |
   | 高可用性      | 启用主节点高可用性。启用高可用性的集群将具有更高的成本。                                                 |
   | 容器网络模式  | 集群中使用的网络模式。`虚拟机` 类型支持 `overlay-l2` 和 `vpc-router` ，`裸机` 类型支持 `underlay-ipvlan` |
   | 容器网络 CIDR | 集群的网络 CIDR。                                                                                        |
   | VPC 名称      | 要部署集群的 VPC 名称。如果为空，Rancher 将创建一个。                                                    |
   | 子网名称      | 集群将部署到的子网名称。如果空白，Rancher 将创建一个。                                                   |
   | 外部服务器    | 该选项是为将来保留的，我们可以通过 API 启用 CCE 集群公共访问。目前，它始终处于禁用状态。                 |
   | 集群标签      | 集群的标签。                                                                                             |
   | 高速子网      | 此选项仅在 `裸机` 类型时可用。它要求您为裸机选择一个高速网络的 VPC。                                     |

7. 填写集群的以下节点配置:

   | 设置         | 描述                                                                                                                                                                                                               |
   | :----------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
   | 区域         | 集群节点所在的可用区域。                                                                                                                                                                                           |
   | 计费方式     | 集群节点的计费方式。在 `虚拟机` 类型中，仅支持 `按使用量付费`。在 `裸机` 中，您可以选择 `按使用量付费` 或 `按年/按月`。                                                                                            |
   | 有效期       | 此选项仅在 `年/月` 计费模式中显示。您要为集群节点支付多长时间的费用。                                                                                                                                              |
   | 自动续定     | 此选项仅在 `年/月` 计费模式中显示。是否在集群节点到期时自动续定。                                                                                                                                                  |
   | 数据卷类型   | 集群节点的数据卷类型。可选项为`SATA` ，`SSD`或者`SAS`。                                                                                                                                                            |
   | 数据卷大小   | 集群节点的数据卷大小。                                                                                                                                                                                             |
   | 根卷类型     | 集群节点的根卷类型。可选项为`SATA` ，`SSD`或者`SAS`。                                                                                                                                                              |
   | 根卷大小     | 集群节点的根卷大小。                                                                                                                                                                                               |
   | 节点规格     | 集群节点的节点规格。Rancher UI 中的规格列表来自华为云。它包括所有支持的节点类型。                                                                                                                                  |
   | 节点数       | 集群的节点数                                                                                                                                                                                                       |
   | 节点操作系统 | 集群节点的操作系统。现在只支持 `EulerOS 2.2` 和 `CentOS 7.4`。                                                                                                                                                     |
   | SSH 密钥名   | 集群节点的 ssh 密钥                                                                                                                                                                                                |
   | EIP          | 集群节点的公用 IP 选项。`禁用`表示集群节点不会绑定公共 IP。`创建EIP` 意味着集群节点将在配置后绑定一个或多个新创建的 EIP，并在 UI 中显示更多选项以设置创建 EIP 参数。`选择已有EIP` 意味着节点将绑定到您选择的 EIP。 |
   | EIP 数量     | 仅当选择 `创建EIP` 时才会显示此选项。这意味着要为节点创建多少 EIP。                                                                                                                                                |
   | EIP 类型     | 仅当选择 `创建EIP` 时才会显示此选项。选项是 `5_bgp` 和 `5_sbgp`。                                                                                                                                                  |
   | EIP 共享类型 | 仅当选择 `创建EIP` 时才会显示此选项。选项为`PER`。                                                                                                                                                                 |
   | EIP 收费模式 | 仅当选择 `创建EIP` 时才会显示此选项。选择是按`带宽`付费还是按`流量`付费。                                                                                                                                          |
   | EIP 带宽大小 | 仅当选择 `创建EIP` 时才会显示此选项。EIP 的带宽。                                                                                                                                                                  |
   | 身份验证模式 | 启用`RBAC`或启用`认证代理`。如果选择 `认证代理`，则还需要提供用于验证代理的证书。                                                                                                                                  |
   | 节点标签     | 集群节点的标签。                                                                                                                                                                                                   |

8. 单击 **创建** ，创建 CCE 集群。

**结果：**

- 您的集群创建成功并进入到**Provisioning**（启动中）的状态。Rancher 正在拉起您的集群。
- 在集群状态变为**Active**（激活）状态后，您将可以开始访问您的集群。
- 在**Active**的集群中，有两个默认项目：`Default`项目（包括`default`命名空间）和`System`项目（包括`cattle-system`、`ingress-nginx`、`kube-public` 和 `kube-system`）。
